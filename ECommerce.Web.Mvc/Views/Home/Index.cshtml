@model ECommerce.Web.Mvc.Models.Home.HomePageViewModel
@{
    ViewData["Title"] = "Home Page";
    var isAdmin = User.IsInRole("Admin") || User.IsInRole("SystemAdmin");
    var isAuthenticated = User.Identity?.IsAuthenticated ?? false;    // kullanılmadı ama özel indirimler vs ileride kullanılabilir--şimdilik kalsın
    var isBuyerOrSeller = User.IsInRole("Buyer") || User.IsInRole("Seller"); // kullanılmadı ama özel indirimler vs ileride kullanılabilir--şimdilik kalsın
}


<!-- HERO SECTION -->
<section class="hero">
    <div class="container">
        <div class="row">
            <!-- Left Category Menu -->
           <!-- Left Category Menu -->
    <div class="col-lg-3">
    <div class="hero__categories">
        <div class="hero__categories__all">
            <i class="fa fa-bars"></i>
            <span>All Categories</span>
        </div>
        @if (!isAdmin && Model.Categories != null)  @* Admin dışındaki kullanıcılar için kategori listesi *@
        {
            <ul>
                @foreach (var cat in Model.Categories)
                {
                    <li>
                        <a href="@Url.Action("Listing", new { category = cat.Name, page = 1 })">
                            @cat.Name
                        </a>
                    </li>
                }
            </ul>
        }
        else
                @* Admin için kategori linklerinin gizlenmesi *@
        {
            <ul>
             @if (Model.Categories != null)
            {
                @foreach (var cat in Model.Categories)
                {
                    <li class="disabled">
                        <span>@cat.Name</span>
                    </li>
                }
            }
            </ul>
            <div class="alert alert-danger">
                <strong>Access Denied:</strong> Admins cannot view products in categories on the user interface.
            </div>
        }
    </div>
    </div>
            
            <!-- Right Hero Content -->
            <div class="col-lg-9">
                <div class="hero__search">
                    <div class="hero__search__form">
                        @if (!isAdmin)
                        {
                            <form method="get" action="@Url.Action("Search", "Product")">
                                <input type="text" name="query" placeholder="Search for a product..." value="@ViewBag.Query">
                                <button type="submit" class="site-btn">SEARCH</button>
                            </form>
                        }
                        else
                        {
                            <p class="text-center">As an admin, you are not authorized to search products here.</p>
                        }
                    </div>

                    <div class="hero__search__phone">
                        <div class="hero__search__phone__icon">
                            <i class="fa fa-phone"></i>
                        </div>
                        <div class="hero__search__phone__text">
                            <h5>+65 11.188.888</h5>
                            <span>support 24/7 time</span>
                        </div>
                    </div>

                </div>

               @*  SPECIAL OFFERS/NEW DISCOUNTS.. *@
                <section class="specialOffers">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-12">
                                <!-- sol kategori menüsüne göre hizalandı -->
                                <div class="special-offers-slider my-slider">
                                    <div class="my-slide" style="background-image: url('@ImageHelper.GetUrl(StaticFiles.FreeShippingBanner)');">
                                        <div class="my-slide-content">
                                            <span style="font-size:40px; font-weight:bold;">Special Offer</span>
                                            <h2>Free Shipping<br>On Orders Over $30</h2>
                                            <p style="font-weight:bold;">Shop your favorites and enjoy fast & free delivery.</p>
                                            <!-- Link to Listing page with 'Free Shipping' category -->
                                            <a href="@Url.Action("Listing", "Home", new { filter = "free-shipping", page = 1 })" class="primary-btn">SHOP NOW</a>
                                        </div>
                                    </div>
                                    <div class="my-slide" style="background-image: url('@ImageHelper.GetUrl(StaticFiles.SaleBanner)');">
                                        <div class="my-slide-content">
                                            <span style="font-size:40px; font-weight:bold;">Limited Time</span>
                                            <h2>Save Up To 40%</h2>
                                            <p>Don't miss exclusive discounts across all categories.</p>
                                            <!-- Link to Listing page with 'Discounted' category -->
                                            <a href="@Url.Action("Listing", "Home", new { filter = "on-sale", page = 1 })" class="primary-btn">BROWSE DEALS</a>
                                        </div>
                                    </div>
                                    <div class="my-slide" style="background-image: url('@ImageHelper.GetUrl(StaticFiles.NewArrivalsBanner)');">
                                        <div class="my-slide-content">
                                            <span style="font-size:40px; font-weight:bold;">New Arrivals</span>
                                            <h2>Fresh Products<br>Just Landed</h2>
                                            <p>Explore the latest additions curated for you.</p>
                                            <!-- Link to Listing page with 'New Arrivals' category -->
                                            <a href="@Url.Action("Listing", "Home", new { filter = "new-arrivals", page = 1 })" class="primary-btn">DISCOVER</a>
                                        </div>
                                    </div>
                                    <!-- Arrows -->
                                    <button class="arrow left">‹</button>
                                    <button class="arrow right">›</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
</section>

<!-- DISCOUNTED PRODUCTS SLIDER (CSS Categories olduğu için class isimlerini değiştirmedim!!!--> 
<section class="discount">
    <div class="container">
        <div class="row">
            <div class="categories__slider discount__slider owl-carousel">
                @foreach (var item in Model.Featured.DiscountedProducts)
                {
                    <div class="col-lg-3">
                        @* Dinamik Ürün Görseli *@
                        <div class="categories__item set-bg" data-setbg="@ImageHelper.GetUrl(item.ImageUrl)">
                            <h5 style="border-radius:10px; font-size: 14px; padding: 5px;"><a href="#" style="border-radius:10px; font-size: 14px; padding: 5px;"> @item.Price.ToString("C", System.Globalization.CultureInfo.GetCultureInfo("en-US")) </a></h5>
                            <span>@((int)((item.OldPrice - item.Price) * 100 /item.OldPrice)) % Discount</span>
                        </div>
                    </div> 
                }
            </div>
        </div>
    </div>
</section>

@* FEATURED PRODUCTS *@
<section class="featured spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="section-title">
                    <h2>Featured Products</h2>
                </div>
                <div class="featured__controls">
                    <ul>
                        <li class="active" data-filter=".popular">Popular Products</li> <!-- default active -->
                        <li data-filter=".new-arrival">New Arrival Products</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row featured__filter">
            <!-- Featured Products (Default olarak Popular) -->
            @foreach (var product in Model.Featured.PopularProducts)
            {
                <div class="col-lg-3 col-md-4 col-sm-6 mix popular">
                    <div class="featured__item">
                        <div class="featured__item__pic set-bg" data-setbg="@ImageHelper.GetUrl(product.ImageUrl)">
                            <ul class="featured__item__pic__hover"></ul>
                        </div>
                             <div class="featured__item__text">
                                <h6 class="fw-bold">
                                    <a asp-controller="Home"
                                       asp-action="ProductDetail"
                                       asp-route-id="@product.Id" style="font-size: 18px;">
                                        @product.Name
                                    </a>
                                </h6>

                                <div class="rating-area">
                                    <span class="stars">
                                        @for (int i = 1; i <= 5; i++)
                                        {
                                            if (i <= product.Rating)
                                            {
                                                <i class="fa fa-star"></i>
                                            }
                                            else
                                            {
                                                <i class="fa fa-star-o"></i>
                                            }
                                        }
                                    </span>

                                    <span class="review-count">
                                        (@product.ReviewCount reviews)
                                    </span>
                                </div>

                            <h5>@product.Price.ToString("C", System.Globalization.CultureInfo.GetCultureInfo("en-US"))</h5>
                            </div>
                     </div>
                </div>
            }

           
            @* New Arrival ürünler başlangıçta gizli *@
            @foreach (var product in Model.Featured.NewArrivalProducts)
            {
                <div class="col-lg-3 col-md-4 col-sm-6 mix new-arrival" style="display:none;">
                    <div class="featured__item">
                        <div class="featured__item__pic set-bg" data-setbg="@ImageHelper.GetUrl(product.ImageUrl)">
                            <ul class="featured__item__pic__hover"></ul>
                        </div>
                        <div class="featured__item__text">
                            <h6 class="fw-bold">
                                <a asp-controller="Home"
                                   asp-action="ProductDetail"
                                   asp-route-id="@product.Id" style="font-size: 18px;">
                                    @product.Name
                                </a>
                            </h6>

                            <div class="rating-area">
                                <span class="stars">
                                    @for (int i = 1; i <= 5; i++)
                                    {
                                        if (i <= product.Rating)
                                        {
                                            <i class="fa fa-star"></i>
                                        }
                                        else
                                        {
                                            <i class="fa fa-star-o"></i>
                                        }
                                    }
                                </span>

                                <span class="review-count">
                                    (@product.ReviewCount reviews)
                                </span>
                            </div>

                            <h5>@product.Price.ToString("C", System.Globalization.CultureInfo.GetCultureInfo("en-US"))</h5>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>


@* Mid Banner silindi *@


<!-- BLOG SECTION -->
<section class="from-blog spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="section-title from-blog__title">
                    <h2>From The Blog</h2>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Example Blog Post -->
            <div class="col-lg-4 col-md-4 col-sm-6">
                <div class="blog__item">
                    <div class="blog__item__pic">
                        <!-- Blog yazısının resmine link ekleyerek dış siteye yönlendirme -->
                        <a href="https://www.siliconmadeacademy.com/" target="_blank">
                            @* Blog Görseli TagHelper Kullanımı *@
                            <my-img file-name="@StaticFiles.BlogCookingTips" alt="Cooking Tips" />
                        </a>
                    </div>
                    <div class="blog__item__text">
                        <ul>
                            <li><i class="fa fa-calendar-o"></i> May 4, 2019</li>
                            <li><i class="fa fa-comment-o"></i> 5</li>
                        </ul>
                        <h5><a href="#">Cooking tips make cooking simple</a></h5>
                        <p>Sed quia non numquam modi tempora indunt ut labore et dolore magnam aliquam quaerat.</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6">
                <div class="blog__item">
                    <div class="blog__item__pic">
                        <!-- Blog yazısının resmine link ekleyerek dış siteye yönlendirme -->
                        <a href="https://www.siliconmadeacademy.com/" target="_blank">
                            <my-img file-name="@StaticFiles.BlogOrganicBenefits" alt="Organic Foods Photo" />
                        </a>
                    </div>
                    <div class="blog__item__text">
                        <ul>
                            <li><i class="fa fa-calendar-o"></i> Nov 7, 2022</li>
                            <li><i class="fa fa-comment-o"></i> 7</li>
                        </ul>
                        <h5><a href="#">Benefits of organic foods</a></h5>
                        <p>Sed quia non numquam modi tempora indunt ut labore et dolore magnam aliquam quaerat.</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6">
                <div class="blog__item">
                    <div class="blog__item__pic">
                        <!-- Blog yazısının resmine link ekleyerek dış siteye yönlendirme -->
                        <a href="https://www.siliconmadeacademy.com/" target="_blank">
                            <my-img file-name="@StaticFiles.BlogFruitRich" alt="Fruits Photo" />
                        </a>
                    </div>
                    <div class="blog__item__text">
                        <ul>
                            <li><i class="fa fa-calendar-o"></i> Sep 3, 2024</li>
                            <li><i class="fa fa-comment-o"></i> 4</li>
                        </ul>
                        <h5><a href="#">Fruits are rich in antioxidants</a></h5>
                        <p>Sed quia non numquam modi tempora indunt ut labore et dolore magnam aliquam quaerat.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    .discount .categories__item span {
      
        color: darkred;
        padding: 5px 10px;
        border-radius: 4px;
        font-weight: bold;

    }

  
    .discount .categories__item h5 {
        background-color: darkred !important;
        color: black !important;
        padding: 5px;
        display: inline-block; /* genişliği içeriğe göre sınırlar */
        width: auto; /* gerekirse belirli bir genişlik */
        max-width: 120px; /* opsiyonel: maksimum genişlik */
       
        }

    .rating-area {
        margin: 5px 0;
        font-size: 16px;
        
    }

        .rating-area .review-count {
            color: #666;
            margin-left: 5px;
        }

        .rating-area .stars {
            color: #FFD700;
        }


/* my-slider padding ve genişlik */
    .my-slider {
        position: relative;
        overflow: hidden;
        height: 50vh;
        max-height: 500px;
    }

    .my-slide {
        position: absolute;
        top: 0;
        transform: translateX(100%);
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        transition: left 1.5s ease-in-out;
        display: flex;
        align-items: center;
        padding: 60px;
        color: #fff;
    }

        /* İlk slide sayfa açılır açılmaz gözükmesi için */
        .my-slide:first-child {
            transform: translateX(0%);
                   
        }


        .my-slide.active {
            transform: translateX(0%);
           
        }

        .my-slide.prev {
            transform: translateX(-100%);
        }

/* slider içeriği */
    .my-slide-content {
        padding: 0 20px; /* Kenarlardan biraz boşluk bırak */
        max-width: 100% !important;
    }

/* oklar */
.my-slider .arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0,0,0,0.4);
    border: none;
    color: #fff;
    padding: 12px 18px;
    font-size: 28px;
    cursor: pointer;
    border-radius: 8px;
}
.my-slider .left { left: 10px; }
.my-slider .right { right: 10px; }

      
</style>




<script>
       document.querySelectorAll('.featured__controls li').forEach(btn => {
        btn.addEventListener('click', function() {
            // Active class'ı ekleyip kaldırma
            document.querySelectorAll('.featured__controls li').forEach(li => li.classList.remove('active'));
            this.classList.add('active');

            const filter = this.getAttribute('data-filter');

            // Tüm öğeleri kontrol et ve geçiş ile göster/gizle
            document.querySelectorAll('.featured__filter .mix').forEach(item => {
                if (item.classList.contains(filter.substring(1))) {
                    // Eşleşen öğeye 'visible' sınıfını ekle, görünür yap
                    item.classList.add('visible');
                } else {
                    // Eşleşmeyen öğeye 'visible' sınıfını kaldır, gizle
                    item.classList.remove('visible');
                }
            });
        });
    });
</script>



<script>

    document.addEventListener("DOMContentLoaded", () => {
        const slides = document.querySelectorAll(".special-offers-slider .my-slide");
        let index = 0;

       
        function showSlide(newIndex) {
            slides.forEach((slide, i) => {
                slide.classList.remove("active", "prev");
                if (i === index) slide.classList.add("prev");   // önceki slide sola kayar
                if (i === newIndex) slide.classList.add("active"); // yeni slide aktif
            });

            index = newIndex;
        }

        document.querySelector(".special-offers-slider .left").addEventListener("click", () => {
            showSlide((index - 1 + slides.length) % slides.length);
        });

        document.querySelector(".special-offers-slider .right").addEventListener("click", () => {
            showSlide((index + 1) % slides.length);
        });

        setInterval(() => {
            showSlide((index + 1) % slides.length);
        }, 7000);

        // Başlangıç
        slides.forEach((slide, i) => {
            slide.classList.remove("active", "prev");
            if (i === 0) slide.classList.add("active");
        });
    });
</script>


